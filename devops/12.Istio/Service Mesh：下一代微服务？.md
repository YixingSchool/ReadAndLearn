

Service Mesh：下一代微服务？ 
http://mp.weixin.qq.com/s/5XIGlqZ20zMSf0EB1XPRvg


2017-11-02 敖小剑 InfoQ

* 微服务
  * 伴随着微服务的大潮，Spring Cloud 微服务开发框架非常普及
  * 新一代的微服务开发技术-`Service Mesh/ 服务网格`-正在悄然兴起
* 什么是 Service Mesh？
  * 定义
    * 服务网格是一个`基础设施层`功能在于处理服务间通信，职责是负责`实现请求的可靠传递`。
    * 在实践中，服务网格通常实现为`轻量级网络代理`，通常与应用程序部署在一起，但是`对应用程序透明`。
  * 简单请求
    * 请求发起者的客户端将请求发送到本地Service Mesh实例
    * Service Mesh完成完整的服务间调用流程
      * 服务发现负载均衡，将请求发送给目标服务
  * Sidecar边三轮
    * 在原有的客户端和服务端之间家多了一个代理
  * 多服务调用
    * Service Mesh在所有的服务下面，服务间通讯专用基础设施层
    * Service Mesh会接管整个网络，把所有的请求在服务之间做转发
    * 如果有大量的服务，就会表现出来网格
* 定义回顾
  * `不再将代理视为单独的组件，而是强调由这些代理连接而形成的网络`
  * 四个特性
    * 抽象：基础设施层
    * 功能：实现请求的可靠传递
    * 部署：轻量级网络代理
    * 关键：对应用程序透明
* Service Mesh 演进历程
  * 第一代网络计算机系统
    * 需要自己在代码里处理网络通信的细节问题，比如数据包顺序、流量控制等等
    * 导致网络逻辑和业务逻辑混杂在一起
    * TCP/IP技术，解决了流量控制问题
  * 微服务时代
    * 开发人员需要在自己的代码里处理一系列问题
    * 服务发现、负载均衡、熔断、重试等
    * 导致应用程序中，在业务逻辑外混杂大量非功能的代码
    * 类库和框架出现
      * Netflix OSS套件，Spring Cloud框架
      * 问题
        * 内容多，门槛高
        * 比学习微服务框架更艰巨的挑战
          * 微服务拆分
          * API设计
          * 数据一致性
          * 康威定律
        * 对于旧有系统，如何进行微服务改造
        * 业务永远看的是结果
        * 服务治理功能不够齐全
        * 无法跨语言
          * 微服务承诺了一个很重要的特性
          * 不同的微服务可以采用自己最擅长最喜欢的最适合的编程语言来编写
        * 版本升级
          * 客户端和服务器端版本不一致，需要解决版本兼容性。
* 思考
  * 根源：最艰巨的挑战，与服务本身无关，而是服务间的通讯
  * 目标：所有的努力，都是为了保证请求发到正确的地方
  * 本质：无论过程如何，请求从不更改
  * 普适：适用于所有的微服务
* 技术栈下移
  * 使用代理解决部分问题
    * 使用nginx，HAProxy，Apache等反向代理，避免服务间产生直接连接
    * 所有流量都经由代理，代理实现需要的特性如负载均衡
  * 在服务端和客户端之间插入`微服务层`完成功能，避免两者之间直接通信
  * sidecar
    * 基础架构部
    * 为特定的基础设施而设计
* 通用型Service Mesh
  * Linkerd
  * Envoy
  * nginmesh
* Service Mesh和Sidecar的差异总结
  * `不再视为单独的组件，而是强调连接形成的网络`
  * Service mesh是通用组件
  * Sidecar是可选的，容许直连。但是Service mesh要求完全掌控所有流量
* Istio
  * 提供一个集中式的控制面板，控制Service Mesh中的所有流量
* lstio的架构
  * 数据面板
  * 控制面板
    * 服务发现、配置、底层抽象、编码规则、管理Envoy
    * 微服务和基础设施的中介层，将策略决策从应用移除并用配置替代
    * 提供服务间认证和终端用户认证使用交互TLS，内置身份和凭据管理

istio中文社区
http://istio.doczh.cn/

