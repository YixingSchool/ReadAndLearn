

双亲委托模型

Java中ClassLoader的加载采用了双亲委托机制，采用双亲委托机制加载类的时候采用如下的几个步骤：

1.  当前ClassLoader首先从自己已经加载的类中查询是否此类已经加载，如果已经加载则直接返回原来已经加载的类。每个类加载器都有自己的加载缓存，当一个类被加载了以后就会放入缓存，等下次加载的时候就可以直接返回了。
2.  当前classLoader的缓存中没有找到被加载的类的时候，委托父类加载器去加载，父类加载器采用同样的策略，首先查看自己的缓存，然后委托父类的父类去加载，一直到bootstrp ClassLoader.
3.  当所有的父类加载器都没有加载的时候，再由当前的类加载器加载，并将其放入它自己的缓存中，以便下次有加载请求的时候直接返回。

* 不同的ClassLoader加载了此类，那么在JVM中它是不同的类
* 当系统需要加载一个类，会先从顶层的启动类加载器开始加载，逐层往下，直到找到该类
* 当判断类是否需要加载时，是从底层的应用类加载器开始判断的，如果已经在应用类加载器中的类，就不会请求上层类加载器

## 自底向上检查类是否加载

* 判断类是否加载时，应用类加载器会顺着双亲路径往上判断，直到启动类加载器
* 启动类加载器不会往下询问，这个委托路线是单向的


## 参考：

1. 实战JAVA虚拟机.JVM故障诊断与性能优化
2. https://blog.csdn.net/wangyang1354/article/details/49448007